#!c:/perl/bin/perl.exe

use strict;
use LWP 5.69;
use HTTP::Request::Common qw( POST );

# Copyright Online-Store.co.uk 2008

# User Defined


# Script Folder
# merchants email address

my $to = '';

# email address that the confirmation emails are sent from

my $from = '';

my $sendmail='/usr/lib/sendmail';


my $doc_dir = '';
my $data_dir = '';



    # Fetch the data for this request.
my $data = "";
my $DEBUG='no';


    if ( $ENV{'REQUEST_METHOD'} eq 'POST' )
       {
       # Read it from standard input.
       my ($len) = $ENV{'CONTENT_LENGTH'};
       if ( read (STDIN, $data, $len) != $len )
         {
         &end_cgi("Error reading 'POST' data");
         }
       }
    else
       {
       # Fetch from environment variable.
       $data = $ENV{'QUERY_STRING'};
       }

my %q = (); # html encoded data
my %u = (); # url encoded data

    # The data is encoded as name1=val1&name2=val2&etc.
    # First split on name/value pairs.
    foreach my $q ( split ('&', $data) ) {
        # Then split name and value.
        my ($name, $val) = split ('=', $q);

        # URL decode and put in resultant hash array.
        
         if ( defined $u{$name} ) {
           # Multiple values. Append using \0 separator.
            $u{$name} .= "\0" . $val;
        }
        else {
            # Store it.
            $u{$name} = $val;
        }
        
       
        
        $name = &url_decode ($name);
        $val  = &url_decode ($val);
        
        #$name=&convert2($name);
        #$val=&convert2($val);
               
        if ( defined $q{$name} ) {
           # Multiple values. Append using \0 separator.
            $q{$name} .= "\0" . $val;
        }
        else {
            # Store it.
            $q{$name} = $val;
        }
      }


 if($q{'delivery_address'} eq "ON")
   {
	   
   $q{'del_first_name'} = $q{'cc_first_name'};
   $q{'del_second_name'} = $q{'cc_last_name'};
   $q{'del_company'} = $q{'cc_company'};
   $q{'del_addr1'} = $q{'cc_addr1'};	   
   $q{'del_addr2'} = $q{'cc_addr2'};
   $q{'del_city'} = $q{'cc_city'};
   $q{'del_state'} = $q{'cc_state'};
   $q{'del_country'} = $q{'cc_country'};
   $q{'del_postalcode'} = $q{'cc_postcode'};
   }
   
        

if($q{'p'} eq '1')
   {
   print "Content-type: text/html\n\n";
   print &order_forms();	   
   #&order_form("aim_cc.html"); 
   exit;
   }  

if($q{'p'} eq '2')
   {
   print "Content-type: text/html\n\n";	
   print &order_forms();   
   #&order_form("aim_echeck.html"); 
   exit;
   }
   
   
if($q{'p'} eq '4')
   {
   print "Content-type: text/html\n\n";	
   print &order_forms();   
   #&order_form("securesource_echeck.html"); 
   exit;
   }
   
   
if($q{'x_method'} eq undef)
   {
&end_cgi("x_method not defined\n\n");	   
	   
}   


my $request_values;

    my $x_currency_code ='USD';
    my $x_test_request = $q{'x_test_request'};

    my $x_reccuring_billing ="NO";
#   my $x_type	= "AUTH_CAPTURE";
#	my $x_type = "AUTH_ONLY";
#	my $x_type = "PRIOR_AUTH_CAPTURE";
#	my $x_type = $q{'x_type'};                         #"PRIOR_AUTH_CAPTURE";
	my $x_card_num	= $q{'cc_number'};
	my $x_exp_date	= $q{'cc_month'} . $q{'cc_year'};
	my $x_card_code = $q{'cc_security_code'}; 
	my $x_description = $q{'x_description'}; 
	my $x_amount = $q{'x_amount'}; 
	my $x_first_name = $q{'cc_first_name'}; 
	my $x_last_name = $q{'cc_last_name'}; 
	my $x_address = $q{'cc_addr1'}; 
	#  $q{'cc_addr2'}
	my $x_city	= $q{'cc_city'} ;
	my $x_state	= $q{'cc_state'};
	my $x_zip	= $q{'cc_postcode'};
	my $x_country = $q{'cc_country'};
	my $x_company = $q{'cc_company'};
	my $x_cust_id = $q{'x_cust_id'}; 
	my $x_invoice_num = time . '-' . $$;
	my $x_phone	= $q{'cc_telephone'};
	my $x_fax	= $q{'x_fax'}; 

	my $x_email = $q{'cc_email'};
	
	my $x_email_customer = ""; 
	my $x_ship_to_first_name = $q{'del_first_name'}; 
	my $x_ship_to_last_name	= $q{'del_last_name'}; 
	my $x_ship_to_company = $q{'del_company'}; 
	my $x_ship_to_address = $q{'del_addr1'};
	# $q{'del_addr2'}
	my $x_ship_to_city = $q{'del_city'};

	my $x_ship_to_state = $q{'del_state'};
	my $x_ship_to_zip =  $q{'del_postalcode'};
	my $x_ship_to_country = $q{'del_country'}; 
	my $x_method=$q{'x_method'}; 

	my $x_po_num= $q{'x_po_num'}; 
	
	my $x_tax	= $q{'x_tax'}; 
	my $x_tax_exempt= $q{'x_tax_exempt'} = 'NO'; 
	my $x_freight= $q{'x_freight'}; 
	my $x_duty	= "0.00";  
   
   
    my $x_customer_ip = $ENV{"REMOTE_ADDR"};    
    
    my $x_trans_id = $q{'x_trans_id'};


###### ECheck Fields #################    
    

my $x_bank_name = $q{'x_bank_name'};   #The name of the customer’s financial institution.

my $x_bank_acct_name = $q{'x_bank_acct_name'};   #customer’s name as it appears on their bank account.

my $x_bank_acct_type = 'CHECKING';    #Describes the type of bank account.

my $x_bank_aba_code =  $q{'x_bank_aba_code'};   #Routing number of a bank for eCheck.Net transactions.

my $x_bank_acct_num = $q{'x_bank_acct_num'};   #Checking or savings account number.

my $x_echeck_type = 'WEB';    #Indicates the type of eCheck.Net payment request.

###### SecureSource Echeck Fields ###########


my $x_customer_organization_type = $q{'x_customer_organization_type'}; # Individual/Business, I/B


my $x_customer_tax_id = $q{'x_customer_tax_id'}; # 9 digits only
# Tax ID or SSN of the customer initiating the transaction.

my $x_drivers_license_num = $q{'x_drivers_license_num'}; # 50 digits
# Required where the Tax ID or SSN is not provided.

my $x_drivers_license_state = $q{'x_drivers_license_state'}; # 2-character state abbreviation

my $x_drivers_license_dob =  $q{'x_drivers_license_dob'};
# drivers_license_dob YYYY-MM-DDD, YYYY/MM/DD, MM/DD/YYYY, MM-DD-YYYY,N/A


my %data;
	
use LWP::UserAgent;
my $ua = new LWP::UserAgent;
my $req = new HTTP::Request POST => "$authorizenet_url";

$req->content_type('text/namevalue');


if($x_method eq "")
   {
   $x_method = 'CC';	
   }
	

   if($q{'Long_Description'} ne undef)
      {
	  $data{'Long_Description'} = $q{'Long_Description'}; 
      }
   

   $data{'x_method'}			= $x_method;	   
   $data{'x_type'}			= $x_type;
   $data{'x_test_request'} = $x_test_request; 
   $data{'x_login'} = $auth_net_login_id; 
   $data{'x_tran_key'}	= $auth_net_tran_key; 
   $data{'x_version'}	= "3.1"; 
   $data{'x_delim_char'} = "|"; 

   $data{'x_delim_data'} = "TRUE"; 
   $data{'x_adc_url'} = "FALSE";
   $data{'x_relay_response'} = "FALSE";
   $data{'x_encap_char'}        = "";
   $data{'x_recurring_billing'} = "NO";
   $data{'x_trans_id'}          = $x_trans_id;
   $data{'x_currency_code'}     = $x_currency_code;
   $data{'x_customer_ip'}       = $x_customer_ip;
   $data{'x_type'}				= $x_type;
   $data{'x_card_num'}	        = $x_card_num;
  
   $data{'x_exp_date'}			= $x_exp_date; 
   $data{'x_description'}		= $x_description;
   $data{'x_amount'}			= $x_amount; 
   $data{'x_first_name'}	    = $x_first_name; 
   $data{'x_last_name'}		    = $x_last_name; 
   $data{'x_address'}		    = $x_address; 
   $data{'x_city'}				= $x_city; 
   $data{'x_state'}			    = $x_state; 
   $data{'x_zip'}				= $x_zip; 
   $data{'x_country'}			= $x_country; 
   $data{'x_company'}			= $x_company; 
   $data{'x_cust_id'}			= $x_cust_id; 
   $data{'x_invoice_num'}		= $x_invoice_num; 
   $data{'x_phone'}			    = $x_phone; 
   $data{'x_fax'}			    = $x_fax; 

   $data{'x_email'}             = $x_email;
   $data{'x_email_customer'}		= $x_email_customer; 
   $data{'x_ship_to_first_name'}	= $x_ship_to_first_name; 
   $data{'x_ship_to_last_name'}		= $x_ship_to_last_name; 
   $data{'x_ship_to_company'}		= $x_ship_to_company; 
   $data{'x_ship_to_address'}		= $x_ship_to_address; 
   $data{'x_ship_to_city'}			= $x_ship_to_city; 
   $data{'x_ship_to_state'}			= $x_ship_to_state; 
   $data{'x_ship_to_zip'}			= $x_ship_to_zip; 
   $data{'x_ship_to_country'}		= $x_ship_to_country;

    ## Level 2 Info	
   $data{'x_po_num'} = $x_po_num; 
   $data{'x_tax'}	 = $x_tax; 
   $data{'x_tax_exempt'} = $x_tax_exempt; 
   $data{'x_freight'} = $x_freight; 
   $data{'x_duty'}	= $x_duty;


if($x_method eq 'ECHECK')
   {
	  
   $data{'x_bank_name'} = $x_bank_name;
   $data{'x_bank_acct_name'} = $x_bank_acct_name;
   $data{'x_bank_acct_type'} = 'CHECKING';
   $data{'x_bank_aba_code'} = $x_bank_aba_code;
   $data{'x_bank_acct_num'} = $x_bank_acct_num;
   $data{'x_echeck_type'}  = $x_echeck_type;
	
	
   $data{'x_customer_organization_type'} = $x_customer_organization_type;
   $data{'x_customer_tax_id'}           = $x_customer_tax_id;
   $data{'x_drivers_license_num'}       = $x_drivers_license_num;
   $data{'x_drivers_license_state'}     = $x_drivers_license_state;
   $data{'x_drivers_license_dob'}       = $x_drivers_license_dob;
    
}	



      
   # $q{"item_number_$n"} = substr($q{"item_number_$n"},0,31);
    
    
   

while(my($first,$last) = each(%data))
   {
	   
   $last = &uri_escape($last);	   
   $req->add_content($first . '='. $last . '&');
   }
   

print "Content-type: text/html\n\n";
   
   
&cart_items();   
   
$req->content_length(length(${$req->content_ref}));


my $response		= $ua->request($req);
my @responses		= split( /$request_values->{x_delim_char}/, $response->content );




     

my $header = qq|
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<title>Authorize.Net AIM Shopping Cart</title>
<meta name="robots" content="noindex,nofollow">

</head>
<body>
|;

my $output .= "$header\n\n";

eval {require LWP};
	if ($@) {
		$output .= "<i>The library www-perl (LWP) is not installed</i><br>\n";
	}else{
		$output .= "Library www-perl (LWP) v$LWP::VERSION installed<br>\n";
	}

my $apiresponse .= $response->content . "<br><br>\n";
my $endoutput .= "</body></html>\n";



# Error handling (very basic)
my $fback;

if( $response->is_success ){
	# Communication was successful
	$fback .= "";
}else{
	$fback .= "We were unable to communicate with the authorizing site.  Please try again.<br>";
}

if($DEBUG eq 'yes')
{
print "$output";
print "<hr>\n";
print "$apiresponse";
print "<hr>\n";
}
print "$fback";
print "<hr>\n";


my $order ="";

my $a = 0;



#$b = 0;
foreach my $pair(@responses){
	# The next statement splits based on the pipe character: |
	my ($name,$val) = split(/\Q|/,$pair);
	$a++;
	}


# split the words using the pipe character (|) as the delimiter.
my @words = split /\Q|/, $apiresponse;

# get the count of the words
my $count = $#words;
	
if($DEBUG eq 'yes')
   {	
   $order .= "Total number of characters in the Authorize.Net gateway response string: $a";
   $order .= "<hr>\n";

   $order .= "Total number of separators in the Authorize.Net gateway response string: $count";
   $order .= "<hr>\n";
   }

# $order .= the parsed words on the console, one in each line

$order .= "<table border='0' cellpadding='1' cellspacing='1'>";


if(@words[0] ne '1')
{

		$order .= "<tr class='trOne' valign='top'><td class='tdOne'>";
		$order .= "Response Reason Text:";
		$order .= "</td><td class='tdTwo'>&nbsp;</td><td class='tdThree'>";
		$order .= "@words[3]\n";
		$order .= "</td></tr>"
}	
	
	
if($DEBUG eq 'yes')
   {	
	
for (my $i=0; $i <=$count; $i++) {

	my $ctr = $i+1;

	if($ctr==1){
		$order .= "<tr class='trOne' valign='top'><td class='tdOne'>";
		$order .= "Response Code:";
		$order .= "</td><td class='tdTwo' width='5'>&nbsp;</td><td class='tdThree'>";
		$order .= "@words[$i]\n";
		$order .= "</td></tr>";
	}elsif($ctr==2){
		$order .= "<tr class='trOne' valign='top'><td class='tdOne'>";
		$order .= "Response Sub-Code:";
		$order .= "</td><td class='tdTwo'>&nbsp;</td><td class='tdThree'>";
		$order .= "@words[$i]\n";
		$order .= "</td></tr>";
	}elsif($ctr==3){
		$order .= "<tr class='trOne' valign='top'><td class='tdOne'>";
		$order .= "Response Reason Code:";
		$order .= "</td><td class='tdTwo'>&nbsp;</td><td class='tdThree'>";
		$order .= "@words[$i]\n";
		$order .= "</td></tr>";
	}elsif($ctr==4){
		$order .= "<tr class='trOne' valign='top'><td class='tdOne'>";
		$order .= "Response Reason Text:";
		$order .= "</td><td class='tdTwo'>&nbsp;</td><td class='tdThree'>";
		$order .= "@words[$i]\n";
		$order .= "</td></tr>";
	}elsif($ctr==5){
		$order .= "<tr class='trOne' valign='top'><td class='tdOne'>";
		$order .= "Approval Code:";
		$order .= "</td><td class='tdTwo'>&nbsp;</td><td class='tdThree'>";
		$order .= "@words[$i]\n";
		$order .= "</td></tr>";
	}elsif($ctr==6){
		$order .= "<tr class='trOne' valign='top'><td class='tdOne'>";
		$order .= "AVS Result Code:";
		$order .= "</td><td class='tdTwo'>&nbsp;</td><td class='tdThree'>";
		$order .= "@words[$i]\n";
		$order .= "</td></tr>";
	}elsif($ctr==7){
		$order .= "<tr class='trOne' valign='top'><td class='tdOne'>";
		$order .= "Transaction ID:";
		$order .= "</td><td class='tdTwo'>&nbsp;</td><td class='tdThree'>";
		$order .= "@words[$i]\n";
		$order .= "</td></tr>";
	}elsif($ctr==8){
		$order .= "<tr class='trOne' valign='top'><td class='tdOne'>";
		$order .= "Invoice Number:";
		$order .= "</td><td class='tdTwo'>&nbsp;</td><td class='tdThree'>";
		$order .= "@words[$i]\n";
		$order .= "</td></tr>";
	}elsif($ctr==9){
		$order .= "<tr class='trOne' valign='top'><td class='tdOne'>";
		$order .= "Description:";
		$order .= "</td><td class='tdTwo'>&nbsp;</td><td class='tdThree'>";
		$order .= "@words[$i]\n";
		$order .= "</td></tr>";
	}elsif($ctr==10){
		$order .= "<tr class='trOne' valign='top'><td class='tdOne'>";
		$order .= "Amount:";
		$order .= "</td><td class='tdTwo'>&nbsp;</td><td class='tdThree'>";
		$order .= "@words[$i]\n";
		$order .= "</td></tr>";
	}elsif($ctr==11){
		$order .= "<tr class='trOne' valign='top'><td class='tdOne'>";
		$order .= "Method:";
		$order .= "</td><td class='tdTwo'>&nbsp;</td><td class='tdThree'>";
		$order .= "@words[$i]\n";
		$order .= "</td></tr>";
	}elsif($ctr==12){
		$order .= "<tr class='trOne' valign='top'><td class='tdOne'>";
		$order .= "Transaction Type:";
		$order .= "</td><td class='tdTwo'>&nbsp;</td><td class='tdThree'>";
		$order .= "@words[$i]\n";
		$order .= "</td></tr>";
	}elsif($ctr==13){
		$order .= "<tr class='trOne' valign='top'><td class='tdOne'>";
		$order .= "Customer ID:";
		$order .= "</td><td class='tdTwo'>&nbsp;</td><td class='tdThree'>";
		$order .= "@words[$i]\n";
		$order .= "</td></tr>";
	}elsif($ctr==14){
		$order .= "<tr class='trOne' valign='top'><td class='tdOne'>";
		$order .= "Cardholder First Name:";
		$order .= "</td><td class='tdTwo'>&nbsp;</td><td class='tdThree'>";
		$order .= "@words[$i]\n";
		$order .= "</td></tr>";
	}elsif($ctr==15){
		$order .= "<tr class='trOne' valign='top'><td class='tdOne'>";
		$order .= "Cardholder Last Name:";
		$order .= "</td><td class='tdTwo'>&nbsp;</td><td class='tdThree'>";
		$order .= "@words[$i]\n";
		$order .= "</td></tr>";
	}elsif($ctr==16){
		$order .= "<tr class='trOne' valign='top'><td class='tdOne'>";
		$order .= "Company:";
		$order .= "</td><td class='tdTwo'>&nbsp;</td><td class='tdThree'>";
		$order .= "@words[$i]\n";
		$order .= "</td></tr>";
	}elsif($ctr==17){
		$order .= "<tr class='trOne' valign='top'><td class='tdOne'>";
		$order .= "Billing Address:";
		$order .= "</td><td class='tdTwo'>&nbsp;</td><td class='tdThree'>";
		$order .= "@words[$i]\n";
		$order .= "</td></tr>";
	}elsif($ctr==18){
		$order .= "<tr class='trOne' valign='top'><td class='tdOne'>";
		$order .= "City:";
		$order .= "</td><td class='tdTwo'>&nbsp;</td><td class='tdThree'>";
		$order .= "@words[$i]\n";
		$order .= "</td></tr>";
	}elsif($ctr==19){
		$order .= "<tr class='trOne' valign='top'><td class='tdOne'>";
		$order .= "State:";
		$order .= "</td><td class='tdTwo'>&nbsp;</td><td class='tdThree'>";
		$order .= "@words[$i]\n";
		$order .= "</td></tr>";
	}elsif($ctr==20){
		$order .= "<tr class='trOne' valign='top'><td class='tdOne'>";
		$order .= "ZIP/Postal Code:";
		$order .= "</td><td class='tdTwo'>&nbsp;</td><td class='tdThree'>";
		$order .= "@words[$i]\n";
		$order .= "</td></tr>";
	}elsif($ctr==21){
		$order .= "<tr class='trOne' valign='top'><td class='tdOne'>";
		$order .= "Country:";
		$order .= "</td><td class='tdTwo'>&nbsp;</td><td class='tdThree'>";
		$order .= "@words[$i]\n";
		$order .= "</td></tr>";
	}elsif($ctr==22){
		$order .= "<tr class='trOne' valign='top'><td class='tdOne'>";
		$order .= "Phone:";
		$order .= "</td><td class='tdTwo'>&nbsp;</td><td class='tdThree'>";
		$order .= "@words[$i]\n";
		$order .= "</td></tr>";
	}elsif($ctr==23){
		$order .= "<tr class='trOne' valign='top'><td class='tdOne'>";
		$order .= "Fax:";
		$order .= "</td><td class='tdTwo'>&nbsp;</td><td class='tdThree'>";
		$order .= "@words[$i]\n";
		$order .= "</td></tr>";
	}elsif($ctr==24){
		$order .= "<tr class='trOne' valign='top'><td class='tdOne'>";
		$order .= "E-Mail Address:";
		$order .= "</td><td class='tdTwo'>&nbsp;</td><td class='tdThree'>";
		$order .= "@words[$i]\n";
		$order .= "</td></tr>";
	}elsif($ctr==25){
		$order .= "<tr class='trOne' valign='top'><td class='tdOne'>";
		$order .= "Ship-to First Name:";
		$order .= "</td><td class='tdTwo'>&nbsp;</td><td class='tdThree'>";
		$order .= "@words[$i]\n";
		$order .= "</td></tr>";
	}elsif($ctr==26){
		$order .= "<tr class='trOne' valign='top'><td class='tdOne'>";
		$order .= "Ship-to Last Name:";
		$order .= "</td><td class='tdTwo'>&nbsp;</td><td class='tdThree'>";
		$order .= "@words[$i]\n";
		$order .= "</td></tr>";
	}elsif($ctr==27){
		$order .= "<tr class='trOne' valign='top'><td class='tdOne'>";
		$order .= "Ship-to Company:";
		$order .= "</td><td class='tdTwo'>&nbsp;</td><td class='tdThree'>";
		$order .= "@words[$i]\n";
		$order .= "</td></tr>";
	}elsif($ctr==28){
		$order .= "<tr class='trOne' valign='top'><td class='tdOne'>";
		$order .= "Ship-to Address:";
		$order .= "</td><td class='tdTwo'>&nbsp;</td><td class='tdThree'>";
		$order .= "@words[$i]\n";
		$order .= "</td></tr>";
	}elsif($ctr==29){
		$order .= "<tr class='trOne' valign='top'><td class='tdOne'>";
		$order .= "Ship-to City:";
		$order .= "</td><td class='tdTwo'>&nbsp;</td><td class='tdThree'>";
		$order .= "@words[$i]\n";
		$order .= "</td></tr>";
	}elsif($ctr==30){
		$order .= "<tr class='trOne' valign='top'><td class='tdOne'>";
		$order .= "Ship-to State:";
		$order .= "</td><td class='tdTwo'>&nbsp;</td><td class='tdThree'>";
		$order .= "@words[$i]\n";
		$order .= "</td></tr>";
	}elsif($ctr==31){
		$order .= "<tr class='trOne' valign='top'><td class='tdOne'>";
		$order .= "Ship-to ZIP/Postal Code:";
		$order .= "</td><td class='tdTwo'>&nbsp;</td><td class='tdThree'>";
		$order .= "@words[$i]\n";
		$order .= "</td></tr>";
	}elsif($ctr==32){
		$order .= "<tr class='trOne' valign='top'><td class='tdOne'>";
		$order .= "Ship-to Country:";
		$order .= "</td><td class='tdTwo'>&nbsp;</td><td class='tdThree'>";
		$order .= "@words[$i]\n";
		$order .= "</td></tr>";
	}elsif($ctr==33){
		$order .= "<tr class='trOne' valign='top'><td class='tdOne'>";
		$order .= "Tax Amount:";
		$order .= "</td><td class='tdTwo'>&nbsp;</td><td class='tdThree'>";
		$order .= "@words[$i]\n";
		$order .= "</td></tr>";
	}elsif($ctr==34){
		$order .= "<tr class='trOne' valign='top'><td class='tdOne'>";
		$order .= "Duty Amount:";
		$order .= "</td><td class='tdTwo'>&nbsp;</td><td class='tdThree'>";
		$order .= "@words[$i]\n";
		$order .= "</td></tr>";
	}elsif($ctr==35){
		$order .= "<tr class='trOne' valign='top'><td class='tdOne'>";
		$order .= "Freight Amount:";
		$order .= "</td><td class='tdTwo'>&nbsp;</td><td class='tdThree'>";
		$order .= "@words[$i]\n";
		$order .= "</td></tr>";
	}elsif($ctr==36){
		$order .= "<tr class='trOne' valign='top'><td class='tdOne'>";
		$order .= "Tax Exempt Flag:";
		$order .= "</td><td class='tdTwo'>&nbsp;</td><td class='tdThree'>";
		$order .= "@words[$i]\n";
		$order .= "</td></tr>";
	}elsif($ctr==37){
		$order .= "<tr class='trOne' valign='top'><td class='tdOne'>";
		$order .= "PO Number:";
		$order .= "</td><td class='tdTwo'>&nbsp;</td><td class='tdThree'>";
		$order .= "@words[$i]\n";
		$order .= "</td></tr>";
	}elsif($ctr==38){
		$order .= "<tr class='trOne' valign='top'><td class='tdOne'>";
		$order .= "MD5 Hash:";
		$order .= "</td><td class='tdTwo'>&nbsp;</td><td class='tdThree'>";
		$order .= "@words[$i]\n";
		$order .= "</td></tr>";
	}elsif($ctr==39){
		$order .= "<tr class='trOne' valign='top'><td class='tdOne'>";
		$order .= "Card Code Verification Result:";
		$order .= "</td><td class='tdTwo'>&nbsp;</td><td class='tdThree'>";
		$order .= "@words[$i]\n";
		$order .= "</td></tr>";
	}elsif($ctr==40 || $ctr==41 || $ctr==42 || $ctr==43 || $ctr==44 || $ctr==45 || $ctr==46 || $ctr==47 || $ctr==48 || $ctr==49 || $ctr==50 || $ctr==51 || $ctr==52 || $ctr==53 || $ctr==54 || $ctr==55 || $ctr==56 || $ctr==57 || $ctr==58 || $ctr==59 || $ctr==60 || $ctr==61 || $ctr==62 || $ctr==63 || $ctr==64 || $ctr==65 || $ctr==66 || $ctr==67 || $ctr==68){
		$order .= "<tr class='trOne' valign='top'><td class='tdOne'>";
		$order .= "Reserved for future use:";
		$order .= "</td><td class='tdTwo'>&nbsp;</td><td class='tdThree'>";
		$order .= "@words[$i]\n";
		$order .= "</td></tr>";
	}elsif($ctr>=69){
		$order .= "<tr class='trOne' valign='top'><td class='tdOne'>";
		$order .= "Merchant-defined:";
		$order .= "</td><td class='tdTwo'>&nbsp;</td><td class='tdThree'>";
		$order .= "@words[$i]\n";
		$order .= "</td></tr>";
	}else{
		$order .= "<tr class='trOne' valign='top'><td class='tdOne' colspan='3'>";
   		$order .= "$ctr: @words[$i]\n";
		$order .= "</td></tr>";
	}
}
$order .= "<tr class='trOne' valign='top'><td class='tdOne' colspan='3'>&nbsp;</td></tr>";
$order .= "</table>";
}
$order .= "<hr>\n";

$order .= "$endoutput";

print $order;
#}
#else
#   {
	

if(@words[0] eq '1')
{	
	
   
my $out = &direct_success_form();


my $table = &make_table();

$out =~ s/BillingCustomerName/@words[13] @words[14]/;
# Company @words[15]    
$out =~ s/BillingStreet1/@words[16]/;  
#$out =~ s/BillingStreet2/$v{''}/;  
$out =~ s/BillingCityName/@words[17]/;  
$out =~ s/BillingStateorProvince/@words[18]/;  
$out =~ s/BillingPostalCode/@words[19]/;  
$out =~ s/BillingCountryName/@words[20]/;


$out =~ s/ShippingCustomerName/@words[24] @words[25]/;
# Company @words[26]    
$out =~ s/ShippingStreet1/@words[27]/;  
#$out =~ s/ShippingStreet2/$v{''}/;  
$out =~ s/ShippingCityName/@words[28]/;  
$out =~ s/ShippingStateorProvince/@words[29]/;  
$out =~ s/ShippingPostalCode/@words[30]/;  
$out =~ s/ShippingCountryName/@words[31]/;  
#$out =~ s/PayPalName/$q{'EMAIL'}/;  
$out =~ s/TransactionID/@words[6]/; 
$out =~ s/<!--table-->/$table/;  
   
   print $out;
   	
#   }

}   

#$contents =~ s/\n/<br>/g;
      
     # my $data_file = ">" . $data_dir . $x_invoice_num . '.htm';
     # open(FILE2,$data_file) || (&end_cgi( "Could not write to $data_file"));
     # print FILE2 $order;
     # close(FILE2);   
         


######################### sub rountines ###################################

sub end_cgi
   {
   my ($i) = @_;
	
   print"Content-Type: text/html\n\n$i\nend\n";

   exit;
   }


sub cart_items
{
 #print "Content-type: text/html\n\n";
 #print "item2<|>golf bag<|>Wilson golf carry bag, red<|>1<|>39.99<|>Y";
 		
my $order='';
my $item_total = 0;


  
for(my $n=1;$q{"item_name_$n"} ne undef;$n++)
   {
	   
   $item_total = $item_total + $q{"amount_$n"};	   
	   
   #if($n>1)
   #   { 	       
   #   if($q{"tax_1"} eq "")
   #      {
   #      $q{"tax_$n"} ="";
   #      }   
   #   else
   #      {
   #      $q{"tax_$n"} ="0.00";
   #      } 
   #   } 
  	
  # my $item_number = $q{"item_number_$n"};   
   
   my $item_name = $q{"item_name_$n"}; 
          
   if($q{"pro_on0_$n"} ne undef)
      {
      $item_name = $item_name . " - " . $q{"pro_on0_$n"} . ":" . $q{"pro_os0_$n"};
      }
   
   if($q{"pro_on1_$n"} ne undef)
      {
      $item_name  =  $item_name  . " - " . $q{"pro_on1_$n"} . ":" . $q{"pro_os1_$n"};
      }
  
   if($q{"pro_on2_$n"} ne undef)
      {
      $item_name  =  $item_name  . " - " . $q{"pro_on2_$n"} . ":" . $q{"pro_os2_$n"};
      }
      
      
    $q{"item_name_$n"} = $item_name;  
   
    my $i=$n-1;
    
      
    $q{"item_number_$n"} = substr($q{"item_number_$n"},0,31);
    
    
    $q{"item_name_$n"} = substr($q{"item_name_$n"},0,255);
    
    
         
    
  my $r4 = $q{"item_number_$n"} . "<|>item$n<|>" . $q{"item_name_$n"} . "<|>" . $q{"quantity_$n"} . "<|>" . $q{"amount_$n"} . "<|>Y"; 

  $r4 = &uri_escape($r4);
  
  $req->add_content('x_line_item='. $r4 . '&');
   
#  print "Content-type: text/html\n\n";
  
 # print $r4 . '<br>';
    
  #  if($q{"L_TAXAMT$i"} ne undef)
  #      {
  # 	 my $m=$n-1;
  #      #$order .= '&L_TAXAMT' . "$i" . "=" . $q{"L_TAXAMT$i"};
  #      $$request_values{'L_TAXAMT'}=$q{"L_TAXAMT$i"};
  #      }

   }
     

}   
   
   
sub order_form
   {
   my ($form) = @_;   
   my $insert =""; 

   while(my($first,$last) = each(%q))
      {
      if(!($first =~ /submit/i)) 
         {	
	     if($first ne 'p') 
            {        
            $insert= $insert . "<input type='hidden' name='$first' value='$last'>" . "\r\n";
            }	
         }
      }
   
   my $file = $doc_dir . $form;
   (open (FILE_LIST, $file) ) || (&end_cgi ("Cannot read $file: $!"));
   #my $output="";
   my $out="";

   while (<FILE_LIST>)
      {
      $out = $out . $_;
      }
      
      
   $out =~ s/<!--paypal_pro_2-->/$insert/;  
      
   $insert= $insert . "<input type='hidden' name='s' value='o'>" . "\r\n";
#   $out =~ s/<!--paypal_pro_1-->/$insert/;     
#$out =~ s/EditShipping/$edit_button/; 
 
   print $out;
   
   close(FILE_LIST);
   
   }
   
sub convert2
   {
   my ($html_info)= @_;
#   $html_info =~ s/&/&amp;/g;      
   $html_info =~ s/"/&quot;/g;

   $html_info =~ s/</&lt;/g;
   $html_info =~ s/>/&gt;/g; 	
   #$html_info =~ s/€/&#8364;/g; 
   
   return($html_info);
   }


sub convert
   {
   my ($html_info)= @_;
#   $html_info =~ s/&/&amp;/g;      
#   $html_info =~ s/"/&quot;/g;

#   $html_info =~ s/</&lt;/g;
#   $html_info =~ s/>/&gt;/g; 	
   #$html_info =~ s/€/&#8364;/g; 
   
   return($html_info);
   }
   
sub unconvert
   {
   my ($html_info)= @_;
#   $html_info =~ s/&amp;/&/g;      
#   $html_info =~ s/&quot;/"/g;

#   $html_info =~ s/&lt;/</g;
#   $html_info =~ s/&gt;/>/g;
   #$html_info =~ s/&#8364;/€/g;  	
   return($html_info);
   }
   
   

sub scan
   {
   my $testc=0;
       

   my ($cc_number) = @_;

	   
   my $new_ccnumber="";

   my $cclen = length($cc_number);
       
   if((index($cc_number,'$') != -1) || (index($cc_number,'£') != -1))
      {
        
      my $startc = index($cc_number,'$')+1;

      if($startc==0)
         {
         $startc = index($cc_number,"£")+1;
         }

                      
      for(my $n=$startc;$n<$cclen;$n++)
         {
         my $tc = substr($cc_number,$n,1);
 
         if($tc eq "0" || $tc eq "1" || $tc eq "2" || $tc eq "3" || $tc eq "4" || $tc eq "5" || $tc eq "6" || $tc eq "7" || $tc eq "8" || $tc eq "9" || $tc eq ".")
            {
            $new_ccnumber = $new_ccnumber . $tc;
            }
         else
            {
            $n = $cclen;
            }
         }    
          
      }
      
      if((index($cc_number,'-$') != -1) || (index($cc_number,'-£') != -1))
         {
	      return -$new_ccnumber; 
         }   
             	
   return $new_ccnumber;
	
   }


   
sub direct_success_form
{

my $output="";
		
$output = '<html>

<head>
<title>Completed Order</title>
</head>

<body onload="focus();" bgcolor="#FFFFFF" text="#000000"
style="font-family: Arial; font-size: 10">

<p><font face="Arial" size="3" color="#008080"><strong>Your Order is Complete</strong></font></p>

<p><font face="Arial" color="#000000" size="2">Please print this receipt for your records.</font></p>

<table border="0" width="623" cellpadding="2" cellspacing="0" bgcolor="#008080">
  <tr>
    <td width="617"></td>
  </tr>
</table>

<table border="0" width="623" cellspacing="0" cellpadding="4" height="45">
  <tr>
    <td width="180"><p align="right"><font face="Arial" size="2"><strong>Billing
    Address: </strong></font></td>
    <td align="left" width="407">BillingCustomerName</td>
  </tr>
  <tr>
    <td width="180"></td>
    <td align="left" width="407">BillingStreet1</td>
  </tr>
 
  <tr>
    <td width="180"></td>
    <td align="left" width="407">BillingCityName, BillingPostalCode</td>
  </tr>
  <tr>
    <td width="180"></td>
    <td align="left" width="407">BillingStateorProvince</td>
  </tr>
  <tr>
    <td width="180"></td>
    <td align="left" width="407">BillingCountryName</td>
  </tr>
  <tr>
    <td width="180"></td>
    <td align="left" width="407">&nbsp;&nbsp;</td>
  </tr>
  <tr>
    <td width="180"></td>
    <td align="left" width="407">&nbsp; </td>
  </tr>
  <tr>
    <td width="180"><p align="right"><strong><font face="Arial" size="2">Shipping
    Address: </font></strong></td>
    <td align="left" width="407">ShippingCustomerName</td>
  </tr>
  <tr>
    <td width="180"></td>
    <td align="left" width="407">ShippingStreet1</td>
  </tr>

  <tr>
    <td width="180"></td>
    <td align="left" width="407">ShippingCityName, ShippingPostalCode</td>
  </tr>
  <tr>
    <td width="180"></td>
    <td align="left" width="407">ShippingStateorProvince</td>
  </tr>
  <tr>
    <td width="180"></td>
    <td align="left" width="407">ShippingCountryName</td>
  </tr>
  <tr>
    <td width="180"></td>
    <td align="left" width="407">&nbsp;&nbsp;</td>
  </tr>
  <tr>
    <td width="180"></td>
    <td align="left" width="407">&nbsp; </td>
  </tr>
</table>

<table border="0" width="623" cellpadding="2" cellspacing="0" bgcolor="#008080">
  <tr>
    <td width="617"><font face="Arial" size="2" color="#FFFFFF"><strong>Billing Information</strong></font></td>
  </tr>
</table>

<table border="0" width="623" cellspacing="0" cellpadding="4" height="45">
 
  <tr>
    <td width="192"><p align="right"><strong><font face="Arial" size="2">Transaction ID:</font></strong></td>
    <td align="left" width="441">TransactionID</td>
  </tr>
</table>

<table border="0" width="623" cellpadding="2" cellspacing="0" bgcolor="#008080">
  <tr>
    <td width="617"><font face="Arial" size="2" color="#FFFFFF"><strong>Order Details</strong></font></td>
  </tr>
</table>

<p>&nbsp;</p>

<table border="1" width="600" cellspacing="0" cellpadding="2">
  <tr>
    <td style="background-color: rgb(220,220,220)" width="50"><strong><font face="Arial"
    size="2">Quantity</font></strong></td>
    <td style="background-color: rgb(220,220,220)" width="50"><font face="Arial" size="2"><strong>Id</strong></font></td>
    <td style="background-color: rgb(220,220,220)" width="450"><strong><font face="Arial"
    size="2">Item</font></strong></td>
    <td style="background-color: rgb(220,220,220)" width="50"><strong><font face="Arial"
    size="2">Price</font></strong></td>
  </tr>
<!--table-->
</table>
</body>
</html>';
	
return $output;	
	
}
   


sub make_table # direct payment
 {
 
 
 my  $n=1;
   
 my $table=""  ;
 
 

   
   while($q{('quantity_' . $n)} ne undef)   
      {
      $table = $table . "<tr><td>$q{('quantity_' . $n)}</td>"; 
      
       $table = $table . "<td>\&nbsp;\&nbsp;$q{('item_number_' . $n)}</td>"; 
      
       $table = $table . "<td>$q{('item_name_' . $n)}"; 
      
      if($q{('pro_on0_' . $n)} ne undef)
         {
         $table = $table . " -- $q{'pro_on0_' . $n}:$q{'pro_os0_' . $n}";
         }
      
      if($q{('pro_on1_' . $n)} ne undef)
         {
         $table = $table . " -- $q{'pro_on1_' . $n}:$q{'pro_os1_' . $n}";
         }   
              
      if($q{('pro_on2_' . $n)} ne undef)
         {
         $table = $table . " -- $q{'pro_on2_' . $n}:$q{'pro_os2_' . $n}";
         }       
         
      $table = $table . "</td>";   
           
      $table = $table . "<td>$q{('amount_' . $n)}</td></tr>"; 
      
      $n++;
      }  
  
     
 if($q{'shipping_1'} ne undef)
    {
    $table = $table . "<tr><td>\&nbsp;</td>";
    $table = $table . "<td>\&nbsp;</td>";
    $table = $table . "<td><p align='right'>Shipping:\&nbsp;</td>";
    $table = $table . "<td>\&nbsp;$q{'shipping_1'}</td></tr>";
    }
 
 if($q{'tax_cart'} ne undef)
    {
   
    $table = $table . "<tr><td>\&nbsp;</td>";
    $table = $table . "<td>\&nbsp;</td>";
    $table = $table . "<td><p align='right'>Tax:\&nbsp;</td>";
    $table = $table . "<td>\&nbsp;$q{'tax_cart'}</td></tr>";
    }
   
 $table = $table . "<tr><td>\&nbsp;</td>";
 $table = $table . "<td>\&nbsp;</td>";
 $table = $table . "<td><p align='right'>Order Total:\&nbsp;</td>";
 $table = $table . "<td>\&nbsp;$x_amount</td></tr>";
 
 $table = $table . "</table>";      
      


 return $table;
 } 


 
sub order_forms
{
	 
my $out = 
'<html>

<head>
<title>Authorize.Net CC Form</title>
<script language="JavaScript">
<!--
function Form_Validator(theForm)
{
if (theForm.cc_number.value == "")
  {
    alert("Please enter a credit card number.");
    theForm.cc_number.focus();
    return (false);
  }

if (theForm.cc_security_code.value == "")
  {
    alert("Please enter a Security Code (CVV).");
    theForm.cc_security_code.focus();
    return (false);
  }
	

if (theForm.cc_first_name.value == "")
  {
    alert("Please enter a value for the \First Name\" field.");
    theForm.cc_first_name.focus();
    return (false);
  }



  if (theForm.cc_last_name.value == "")
  {
    alert("Please enter a value for the \Last Name\" field.");
    theForm.cc_last_name.focus();
    return (false);
  }

 
  if (theForm.cc_addr1.value == "")
  {
    alert("Please enter a value for the \"Address\" field.");
    theForm.cc_addr1.focus();
    return (false);
  }


 if (theForm.cc_city.value == "")
  {
    alert("Please enter a value for the \"Town City\" field.");
    theForm.cc_city.focus();
    return (false);
  }



  if (theForm.cc_postcode.value == "")
  {
    alert("Please enter a value for the \"Postal Code\" field.");
    theForm.cc_postcode.focus();
    return (false);
  }



  if (theForm.cc_email.value == "")
  {
    alert("Please enter a value for the \"E-Mail Address\" field.");
    theForm.cc_email.focus();
    return (false);
  }


  return (true);
}
//--></script>
</head>

<body onload="focus();" bgcolor="#ffffff" text="#000000">

<p>&nbsp;</p>';



if($q{'p'} eq '1')
   {

$out .= '<table border="0" width="621" cellpadding="2" cellspacing="0" bgcolor="#008080">
  <tr>
    <td width="615"><font face="Arial" size="2" color="#FFFFFF"><strong>Credit Card Details</strong></font></td>
  </tr>
</table>';
   }
   
else
   {

$out .= '<table border="0" width="621" cellpadding="2" cellspacing="0" bgcolor="#008080">
  <tr>
    <td width="615"><font face="Arial" size="2" color="#FFFFFF"><strong>Bank Account Details</strong></font></td>
  </tr>
</table><br>';
   }      
   
   

$out .= '<form method="POST" action="authorize_net_aim.pl" name="Form1"
onsubmit="return Form_Validator(this)">
  <input type="hidden" name="Action" value="send_all"><input type="hidden" name="e_mail"
  value="e_mail_address"><input type="hidden" name="cgi-form" value="true"><input
  type="hidden" name="pro" value="2"><input type="hidden" name="epdq" value="true"><!--info_goes_here-->
<table
  border="0" height="174" cellspacing="0" cellpadding="0" width="615">
<tbody>';

if($q{'p'} eq '1')
   {
$out .=

    '<tr>
      <td height="23" width="245" align="right"></td>
      <td align="left" height="23" width="332"></td>
    </tr>
    <tr>
      <td height="23" width="245" align="right"><font face="Arial" size="2">Credit Card
      Number:&nbsp; </font></td>
      <td align="left" height="23" width="332"><input name="cc_number" size="40" type="text"
      value=""></td>
    </tr>
    <tr>
      <td height="23" width="245" align="right"><font face="Arial" size="2">Security Code
      (CVV):&nbsp; </font></td>
      <td align="left" height="23" width="332"><font face="Arial" size="3"><input
      name="cc_security_code" size="3" MAXLENGTH="3" type="text" value=""></font></td>
    </tr>
    <tr>
      <td height="23" width="245" align="right"><font face="Arial" size="2">Expiration
      Date:&nbsp; </font></td>
      <td align="left" height="23" width="332"><select name="cc_month" size="1">
        <option value="01">01</option>
        <option value="02">02</option>
        <option value="03">03</option>
        <option value="04">04</option>
        <option value="05">05</option>
        <option value="06">06</option>
        <option value="07">07</option>
        <option value="08">08</option>
        <option value="09">09</option>
        <option value="10">10</option>
        <option value="11">11</option>
        <option value="12">12</option>
      </select><select name="cc_year" size="1">
        <option value="2006">2006</option>
        <option value="2007">2007</option>
        <option value="2008">2008</option>
        <option value="2009">2009</option>
        <option selected value="2010">2010</option>
        <option value="2011">2011</option>
        <option value="2012">2012</option>
        <option value="2013">2013</option>
        <option value="2014">2014</option>
        <option value="2015">2015</option>
        <option value="2016">2016</option>
        <option value="2017">2017</option>
        <option value="2018">2018</option>
        <option value="2019">2019</option>
        <option value="2020">2020</option>
      </select></td>
    </tr>
    <tr>
      <td colspan="2" height="2" width="615">&nbsp;&nbsp;</td>
    </tr>';
    }
    
    
if($q{'p'} eq '2')
   {    
$out .=    
    
   '<tr>
      <td height="23" width="245" align="right"><font face="Arial" size="2">Name of your
      Bank:&nbsp; </font></td>
      <td align="left" height="23" width="332"><input name="x_bank_name" size="40" type="text"
      value=""></td>
    </tr>
    <tr>
      <td height="23" width="245" align="right"><font face="Arial" size="2">Name that appears on
      your bank account:&nbsp; </font></td>
      <td align="left" height="23" width="332"><input name="x_bank_acct_name" size="40"
      type="text" value=""></td>
    </tr>
    <tr>
      <td height="23" width="245" align="right">Routing number of bank for eCheck.Net
      transactions<font face="Arial" size="2">:&nbsp; </font></td>
      <td align="left" height="23" width="332"><input name="x_bank_aba_code" size="40"
      type="text" value=""></td>
    </tr>
    <tr>
      <td height="23" width="245" align="right">Bank Account Number<font face="Arial" size="2">:&nbsp;
      </font></td>
      <td align="left" height="23" width="332"><input name="x_bank_acct_num" size="40"
      type="text" value=""></td>
    </tr>
    <tr>
      <td colspan="2" height="2" width="615">&nbsp;&nbsp;</td>
    </tr>
    <tr>';
    }
    
if($q{'p'} eq '4')
   {
	 $out .=   '<tr>
      <td height="23" width="245" align="right"><font face="Arial" size="2">Name of your
      Bank:&nbsp; </font></td>
      <td align="left" height="23" width="332"><input name="x_bank_name" size="40" type="text"
      value=""></td>
    </tr>
    <tr>
      <td height="23" width="245" align="right"><font face="Arial" size="2">Name that appears on
      your bank account:&nbsp; </font></td>
      <td align="left" height="23" width="332"><input name="x_bank_acct_name" size="40"
      type="text" value=""></td>
    </tr>
    <tr>
      <td height="23" width="245" align="right">Routing number of bank for eCheck.Net
      transactions<font face="Arial" size="2">:&nbsp; </font></td>
      <td align="left" height="23" width="332"><input name="x_bank_aba_code" size="40"
      type="text" value=""></td>
    </tr>
    <tr>
      <td height="23" width="245" align="right">Bank Account Number<font face="Arial" size="2">:&nbsp;
      </font></td>
      <td align="left" height="23" width="332"><input name="x_bank_acct_num" size="40"
      type="text" value=""></td>
    </tr>
    <tr>
      <td colspan="2" height="2" width="615"></td>
    </tr>
    <tr>
      <td height="23" width="245" align="right">Customer Type<font face="Arial" size="2">:&nbsp;
      </font></td>
      <td align="left" height="23" width="332"><select name="x_customer_organization_type"
      size="1">
        <option value="I">Individual</option>
        <option value="B">Business</option>
      </select></td>
    </tr>
    <tr>
      <td height="23" width="245" align="right">Customer Tax ID or SSN<font face="Arial"
      size="2">:&nbsp; </font></td>
      <td align="left" height="23" width="332"><input name="x_customer_tax_id" size="40"
      type="text" value="" maxlength="9"></td>
    </tr>
    <tr>
      <td height="23" width="245" align="right">Drivers License Num<font face="Arial" size="2">ber:&nbsp;
      </font></td>
      <td align="left" height="23" width="332"><input name="x_drivers_license_num" size="40"
      type="text" value="" maxlength="50"></td>
    </tr>
    <tr>
      <td height="23" width="245" align="right">Drivers License State<font face="Arial" size="2">:&nbsp;
      </font></td>
      <td align="left" height="23" width="332">      
      <select name="x_drivers_license_state" size="1">
        <option selected value ="None">Select a State</option>
        <option value="AB">Alberta</option>
        <option value="AL">Alabama</option>
        <option value="AK">Alaska</option>
        <option value="AZ">Arizona</option>
        <option value="AR">Arkansas</option>
        <option value="BC">British Columbia</option>
        <option value="CA">California</option>
        <option value="CO">Colorado</option>
        <option value="CT">Connecticut</option>
        <option value="DE">Delaware</option>
        <option value="DC">District of Columbia</option>
        <option value="FL">Florida</option>
        <option value="GA">Georgia</option>
        <option value="HI">Hawaii</option>
        <option value="ID">Idaho</option>
        <option value="IL">Illinois</option>
        <option value="IN">Indiana</option>
        <option value="IA">Iowa</option>
        <option value="KS">Kansas</option>
        <option value="KY">Kentucky</option>
        <option value="LA">Louisiana</option>
        <option value="MB">Manitoba</option>
        <option value="ME">Maine</option>
        <option value="MD">Maryland</option>
        <option value="MA">Massachusetts</option>
        <option value="MI">Michigan</option>
        <option value="MN">Minnesota</option>
        <option value="MS">Mississippi</option>
        <option value="MO">Missouri</option>
        <option value="MT">Montana</option>
        <option value="NE">Nebraska</option>
        <option value="NV">Nevada</option>
        <option value="NB">New Brunswick</option>
        <option value="NH">New Hampshire</option>
        <option value="NJ">New Jersey</option>
        <option value="NM">New Mexico</option>
        <option value="NY">New York</option>
        <option value="NC">North Carolina</option>
        <option value="ND">North Dakota</option>
        <option value="NL">Newfoundland</option>
        <option value="NS">Nova Scotia</option>
        <option value="NT">Northwest Territories</option>
        <option value="NU">Nunavut</option>
        <option value="OH">Ohio</option>
        <option value="OK">Oklahoma</option>
        <option value="ON">Ontario</option>
        <option value="OR">Oregon</option>
        <option value="PA">Pennsylvania</option>
        <option value="PE">Prince Edward Island</option>
        <option value="QC">Quebec</option>
        <option value="RI">Rhode Island</option>
        <option value="SK">Saskatchewan</option>
        <option value="SC">South Carolina</option>
        <option value="SD">South Dakota</option>
        <option value="TN">Tennessee</option>
        <option value="TX">Texas</option>
        <option value="UT">Utah</option>
        <option value="VT">Vermont</option>
        <option value="VA">Virginia</option>
        <option value="WA">Washington</option>
        <option value="WV">West Virginia</option>
        <option value="WI">Wisconsin</option>
        <option value="WY">Wyoming</option>
        <option value="YT">Yukon</option>
      </select>
      </td>
    </tr>
    <tr>
      <td height="23" width="245" align="right">Drivers License Date of Birth (MM-DD-YYYY)<font
      face="Arial" size="2">:&nbsp; </font></td>
      <td align="left" height="23" width="332"><input name="x_drivers_license_dob" size="40"
      type="text" value="" maxlength="10"></td>
    </tr>';
   }
	       
    
$out .=
    
    '<tr>
      <td height="23" width="245" align="right"></td>
      <td align="left" height="23" width="332"></td>
    </tr>
    <tr>
      <td colspan="2" height="2" width="615" style="background-color: rgb(0,128,128)"><font
      face="Arial" size="2" color="#FFFFFF"><strong>Billing Address</strong></font></td>
    </tr>
    <tr>
      <td height="23" width="245" align="right"></td>
      <td align="left" height="23" width="332"></td>
    </tr>
    <tr>
      <td colspan="2" height="2" width="615"></td>
    </tr>
    <tr>
      <td height="23" width="223" align="right"><font face="Arial" size="2">First Name:</font></td>
      <td align="left" height="23" width="392"><font face="Arial" size="3"><input
      name="cc_first_name" size="40" type="text" value=""></font></td>
    </tr>
    <tr>
      <td height="23" width="223" align="right"><font face="Arial" size="2">Last Name:</font></td>
      <td align="left" height="23" width="392"><font face="Arial" size="3"><input
      name="cc_last_name" size="40" type="text" value=""></font></td>
    </tr>
    <tr>
      <td height="23" width="223" align="right"><font face="Arial" size="2">Company:</font></td>
      <td align="left" height="23" width="392"><font face="Arial" size="3"><input
      name="cc_company" size="40" type="text" value=""></font></td>
    </tr>
        <tr>
      <td height="23" width="223" align="right"><font face="Arial" size="2">Address:</font></td>
      <td align="left" height="23" width="392"><font face="Arial" size="3"><input
      name="cc_addr1" size="40" type="text" value=""></font></td>
    </tr>
    <tr>
      <td height="23" width="223"></td>
      <td align="left" height="23" width="392"><font face="Arial" size="3"><input
      name="cc_addr2" size="40" type="text" value=""></font></td>
    </tr>
    <tr>
      <td height="23" width="223" align="right"><font face="Arial" size="2">Town/City:</font></td>
      <td align="left" height="23" width="392"><font face="Arial" size="3"><input name="cc_city"
      size="40" type="text" value=""></font></td>
    </tr>
    <tr>
      <td height="23" width="223" align="right"><font face="Arial" size="2">US State or Canadian
      Province:</font></td>
      <td align="left" height="23" width="392"><select name="cc_state" size="1">
        <option selected value ="None">Select a State or Province</option>
        <option value="AB">Alberta</option>
        <option value="AL">Alabama</option>
        <option value="AK">Alaska</option>
        <option value="AZ">Arizona</option>
        <option value="AR">Arkansas</option>
        <option value="BC">British Columbia</option>
        <option value="CA">California</option>
        <option value="CO">Colorado</option>
        <option value="CT">Connecticut</option>
        <option value="DE">Delaware</option>
        <option value="DC">District of Columbia</option>
        <option value="FL">Florida</option>
        <option value="GA">Georgia</option>
        <option value="HI">Hawaii</option>
        <option value="ID">Idaho</option>
        <option value="IL">Illinois</option>
        <option value="IN">Indiana</option>
        <option value="IA">Iowa</option>
        <option value="KS">Kansas</option>
        <option value="KY">Kentucky</option>
        <option value="LA">Louisiana</option>
        <option value="MB">Manitoba</option>
        <option value="ME">Maine</option>
        <option value="MD">Maryland</option>
        <option value="MA">Massachusetts</option>
        <option value="MI">Michigan</option>
        <option value="MN">Minnesota</option>
        <option value="MS">Mississippi</option>
        <option value="MO">Missouri</option>
        <option value="MT">Montana</option>
        <option value="NE">Nebraska</option>
        <option value="NV">Nevada</option>
        <option value="NB">New Brunswick</option>
        <option value="NH">New Hampshire</option>
        <option value="NJ">New Jersey</option>
        <option value="NM">New Mexico</option>
        <option value="NY">New York</option>
        <option value="NC">North Carolina</option>
        <option value="ND">North Dakota</option>
        <option value="NL">Newfoundland</option>
        <option value="NS">Nova Scotia</option>
        <option value="NT">Northwest Territories</option>
        <option value="NU">Nunavut</option>
        <option value="OH">Ohio</option>
        <option value="OK">Oklahoma</option>
        <option value="ON">Ontario</option>
        <option value="OR">Oregon</option>
        <option value="PA">Pennsylvania</option>
        <option value="PE">Prince Edward Island</option>
        <option value="QC">Quebec</option>
        <option value="RI">Rhode Island</option>
        <option value="SK">Saskatchewan</option>
        <option value="SC">South Carolina</option>
        <option value="SD">South Dakota</option>
        <option value="TN">Tennessee</option>
        <option value="TX">Texas</option>
        <option value="UT">Utah</option>
        <option value="VT">Vermont</option>
        <option value="VA">Virginia</option>
        <option value="WA">Washington</option>
        <option value="WV">West Virginia</option>
        <option value="WI">Wisconsin</option>
        <option value="WY">Wyoming</option>
        <option value="YT">Yukon</option>
      </select> </td>
    </tr>
    <tr>
      <td height="23" width="223" align="right"><font face="Arial" size="2">Country:</font></td>
      <td align="left" height="23" width="392"><select name="cc_country" size="1">
        <option selected value ="None">Select a country </option>
        <option value="AF">Afghanistan </option>
        <option value="AL">Albania </option>
        <option value="DZ">Algeria </option>
        <option value="AS">American Samoa </option>
        <option value="AD">Andorra </option>
        <option value="AO">Angola </option>
        <option value="AI">Anguilla </option>
        <option value="AQ">Antarctica </option>
        <option value="AG">Antigua And Barbuda </option>
        <option value="AR">Argentina </option>
        <option value="AM">Armenia </option>
        <option value="AW">Aruba </option>
        <option value="AU">Australia </option>
        <option value="AT">Austria </option>
        <option value="AZ">Azerbaijan </option>
        <option value="BS">Bahamas </option>
        <option value="BH">Bahrain </option>
        <option value="BD">Bangladesh </option>
        <option value="BB">Barbados </option>
        <option value="BY">Belarus </option>
        <option value="BE">Belgium </option>
        <option value="BZ">Belize </option>
        <option value="BJ">Benin </option>
        <option value="BM">Bermuda </option>
        <option value="BT">Bhutan </option>
        <option value="BO">Bolivia </option>
        <option value="BA">Bosnia And Herzegowina </option>
        <option value="BW">Botswana </option>
        <option value="BV">Bouvet Island </option>
        <option value="BR">Brazil </option>
        <option value="IO">British Indian Ocean Territory </option>
        <option value="BN">Brunei Darussalam </option>
        <option value="BG">Bulgaria </option>
        <option value="BF">Burkina Faso </option>
        <option value="BI">Burundi </option>
        <option value="KH">Cambodia </option>
        <option value="CM">Cameroon </option>
        <option value="CA">Canada </option>
        <option value="CV">Cape Verde </option>
        <option value="KY">Cayman Islands </option>
        <option value="CF">Central African Republic </option>
        <option value="TD">Chad </option>
        <option value="CL">Chile </option>
        <option value="CN">China </option>
        <option value="CX">Christmas Island </option>
        <option value="CC">Cocos (Keeling) Islands </option>
        <option value="CO">Colombia </option>
        <option value="KM">Comoros </option>
        <option value="CG">Congo </option>
        <option value="CK">Cook Islands </option>
        <option value="CR">Costa Rica </option>
        <option value="CI">Cote D Ivoire </option>
        <option value="HR">Croatia </option>
        <option value="CU">Cuba </option>
        <option value="CY">Cyprus </option>
        <option value="CZ">Czech Republic </option>
        <option value="DK">Denmark </option>
        <option value="DJ">Djibouti </option>
        <option value="DM">Dominica </option>
        <option value="DO">Dominican Republic </option>
        <option value="TP">East Timor </option>
        <option value="EC">Ecuador </option>
        <option value="EG">Egypt </option>
        <option value="SV">El Salvador </option>
        <option value="GQ">Equatorial Guinea </option>
        <option value="ER">Eritrea </option>
        <option value="EE">Estonia </option>
        <option value="ET">Ethiopia </option>
        <option value="FK">Falkland Islands </option>
        <option value="FO">Faroe Islands </option>
        <option value="FJ">Fiji </option>
        <option value="FI">Finland </option>
        <option value="FR">France </option>
        <option value="FX">France, Metropolitan </option>
        <option value="GF">French Guiana </option>
        <option value="PF">French Polynesia </option>
        <option value="TF">French Southern Territories </option>
        <option value="GA">Gabon </option>
        <option value="GM">Gambia </option>
        <option value="GE">Georgia </option>
        <option value="DE">Germany </option>
        <option value="GH">Ghana </option>
        <option value="GI">Gibraltar </option>
        <option value="GR">Greece </option>
        <option value="GL">Greenland </option>
        <option value="GD">Grenada </option>
        <option value="GP">Guadeloupe </option>
        <option value="GU">Guam </option>
        <option value="GT">Guatemala </option>
        <option value="GN">Guinea </option>
        <option value="GW">Guinea-Bissau </option>
        <option value="GY">Guyana </option>
        <option value="HT">Haiti </option>
        <option value="HM">Heard And Mc Donald Islands </option>
        <option value="HN">Honduras </option>
        <option value="HK">Hong Kong </option>
        <option value="HU">Hungary </option>
        <option value="IS">Iceland </option>
        <option value="IN">India </option>
        <option value="ID">Indonesia </option>
        <option value="IR">Iran </option>
        <option value="IQ">Iraq </option>
        <option value="IE">Ireland </option>
        <option value="IL">Israel </option>
        <option value="IT">Italy </option>
        <option value="JM">Jamaica </option>
        <option value="JP">Japan </option>
        <option value="JO">Jordan </option>
        <option value="KZ">Kazakhstan </option>
        <option value="KE">Kenya </option>
        <option value="KI">Kiribati </option>
        <option value="KP">North Korea </option>
        <option value="KR">South Korea </option>
        <option value="KW">Kuwait </option>
        <option value="KG">Kyrgyzstan </option>
        <option value="LA">Lao Peoples Republic </option>
        <option value="LV">Latvia </option>
        <option value="LB">Lebanon </option>
        <option value="LS">Lesotho </option>
        <option value="LR">Liberia </option>
        <option value="LY">Libyan Arab Jamahiriya </option>
        <option value="LI">Liechtenstein </option>
        <option value="LT">Lithuania </option>
        <option value="LU">Luxembourg </option>
        <option value="MO">Macau </option>
        <option value="MK">Macedonia </option>
        <option value="MG">Madagascar </option>
        <option value="MW">Malawi </option>
        <option value="MY">Malaysia </option>
        <option value="MV">Maldives </option>
        <option value="ML">Mali </option>
        <option value="MT">Malta </option>
        <option value="MH">Marshall Islands </option>
        <option value="MQ">Martinique </option>
        <option value="MR">Mauritania </option>
        <option value="MU">Mauritius </option>
        <option value="YT">Mayotte </option>
        <option value="MX">Mexico </option>
        <option value="FM">Micronesia </option>
        <option value="MD">Moldova </option>
        <option value="MC">Monaco </option>
        <option value="MN">Mongolia </option>
        <option value="MS">Montserrat </option>
        <option value="MA">Morocco </option>
        <option value="MZ">Mozambique </option>
        <option value="MM">Myanmar </option>
        <option value="NA">Namibia </option>
        <option value="NR">Nauru </option>
        <option value="NP">Nepal </option>
        <option value="NL">Netherlands </option>
        <option value="AN">Netherlands Antilles </option>
        <option value="NC">New Caledonia </option>
        <option value="NZ">New Zealand </option>
        <option value="NI">Nicaragua </option>
        <option value="NE">Niger </option>
        <option value="NG">Nigeria </option>
        <option value="NU">Niue </option>
        <option value="NF">Norfolk Island </option>
        <option value="MP">Northern Mariana Islands </option>
        <option value="NO">Norway </option>
        <option value="OM">Oman </option>
        <option value="PK">Pakistan </option>
        <option value="PW">Palau </option>
        <option value="PA">Panama </option>
        <option value="PG">Papua New Guinea </option>
        <option value="PY">Paraguay </option>
        <option value="PE">Peru </option>
        <option value="PH">Philippines </option>
        <option value="PN">Pitcairn </option>
        <option value="PL">Poland </option>
        <option value="PT">Portugal </option>
        <option value="PR">Puerto Rico </option>
        <option value="QA">Qatar </option>
        <option value="RE">Reunion </option>
        <option value="RO">Romania </option>
        <option value="RU">Russian Federation </option>
        <option value="RW">Rwanda </option>
        <option value="KN">Saint Kitts And Nevis </option>
        <option value="LC">Saint Lucia </option>
        <option value="VC">Saint Vincent And The Grenadines </option>
        <option value="WS">Samoa </option>
        <option value="SM">San Marino </option>
        <option value="ST">Sao Tome And Principe </option>
        <option value="SA">Saudi Arabia </option>
        <option value="SN">Senegal </option>
        <option value="SC">Seychelles </option>
        <option value="SL">Sierra Leone </option>
        <option value="SG">Singapore </option>
        <option value="SK">Slovakia </option>
        <option value="SI">Slovenia </option>
        <option value="SB">Solomon Islands </option>
        <option value="SO">Somalia </option>
        <option value="ZA">South Africa </option>
        <option value="GS">South Georgia And The South Sandwich Islands </option>
        <option value="ES">Spain </option>
        <option value="LK">Sri Lanka </option>
        <option value="SH">St Helena </option>
        <option value="PM">St Pierre and Miquelon </option>
        <option value="SD">Sudan </option>
        <option value="SR">Suriname </option>
        <option value="SJ">Svalbard And Jan Mayen Islands </option>
        <option value="SZ">Swaziland </option>
        <option value="SE">Sweden </option>
        <option value="CH">Switzerland </option>
        <option value="SY">Syrian Arab Republic </option>
        <option value="TW">Taiwan </option>
        <option value="TJ">Tajikistan </option>
        <option value="TZ">Tanzania </option>
        <option value="TH">Thailand </option>
        <option value="TG">Togo </option>
        <option value="TK">Tokelau </option>
        <option value="TO">Tonga </option>
        <option value="TT">Trinidad And Tobago </option>
        <option value="TN">Tunisia </option>
        <option value="TR">Turkey </option>
        <option value="TM">Turkmenistan </option>
        <option value="TC">Turks And Caicos Islands </option>
        <option value="TV">Tuvalu </option>
        <option value="UG">Uganda </option>
        <option value="UA">Ukraine </option>
        <option value="AE">United Arab Emirates </option>
        <option value="GB">United Kingdom</option>
        <option value="US">United States</option>
        <option value="UM">United States Minor Outlying Islands </option>
        <option value="UY">Uruguay </option>
        <option value="UZ">Uzbekistan </option>
        <option value="VU">Vanuatu </option>
        <option value="VA">Vatican City State </option>
        <option value="VE">Venezuela </option>
        <option value="VN">Viet Nam </option>
        <option value="VG">Virgin Islands (British) </option>
        <option value="VI">Virgin Islands (U.S.) </option>
        <option value="WF">Wallis And Futuna Islands </option>
        <option value="EH">Western Sahara </option>
        <option value="YE">Yemen </option>
        <option value="ZR">Zaire </option>
        <option value="ZM">Zambia </option>
        <option value="ZW">Zimbabwe </option>
        <option value="ZZ">Other-Not Shown </option>
      </select></td>
    </tr>
    <tr>
      <td height="1" width="223" align="right"><font face="Arial" size="2">Post/Zip/Area Code:</font></td>
      <td align="left" height="1" width="392"><font face="Arial" size="3"><input
      name="cc_postcode" size="20" type="text" value=""></font></td>
    </tr>
    <tr>
      <td height="1" width="223" align="right"><font face="Arial" size="2">E-Mail:</font></td>
      <td align="left" height="1" width="392"><font face="Arial" size="3"><input name="cc_email"
      size="20" type="text" value=""></font></td>
    </tr>
    <tr>
      <td height="1" width="223" align="right"><font face="Arial" size="2">Telephone Number: </font></td>
      <td align="left" height="1" width="392"><font face="Arial" size="3"><input
      name="cc_telephone" size="20" type="text" value=""></font></td>
    </tr>
    <tr>
      <td height="1" width="223" align="right"><font face="Arial" size="2">Fax Number: </font></td>
      <td align="left" height="1" width="392"><font face="Arial" size="3"><input name="x_fax"
      size="20" type="text" value="" maxlength="25"></font></td>
    </tr>
    <tr>
      <td height="1" width="223">&nbsp;&nbsp;</td>
      <td align="left" height="1" width="392"></td>
    </tr>
    <tr>
      <td height="0" width="223" align="right"><strong><font face="Arial" size="2">Delivery
      Address: </font></strong></td>
      <td align="left" height="0" width="392"><font face="Arial" size="2">Tick box </font><input
      type="checkbox" name="delivery_address" value="ON"
      onclick="del_first_name.value=cc_first_name.value;
del_last_name.value=cc_last_name.value;
del_addr1.value=cc_addr1.value;
del_addr2.value=cc_addr2.value;
del_city.value=cc_city.value;
del_state.value=cc_state.value;
del_postalcode.value=cc_postcode.value;
del_country.value=cc_country.value;
del_company.value=cc_company.value;
"><font
      face="Arial" size="2"> if Delvery Address is the same as Billing Address </font></td>
    </tr>
    <tr>
      <td height="1" width="223">&nbsp;&nbsp;</td>
      <td align="left" height="1" width="392"></td>
    </tr>
    <tr>
      <td height="23" width="223" align="right"><font face="Arial" size="2">First Name:</font></td>
      <td align="left" height="23" width="392"><font face="Arial" size="3"><input
      name="del_first_name" size="40" type="text" value=""></font></td>
    </tr>
    
    <tr align="center">
      <td height="23" width="223" align="right"><font face="Arial" size="2">Last Name:</font></td>
      <td align="left" height="23" width="392"><font face="Arial" size="3"><input
      name="del_last_name" size="40" type="text" value=""></font></td>
    </tr>
    
    <tr align="center">
      <td height="23" width="223" align="right"><font face="Arial" size="2">Company:</font></td>
      <td align="left" height="23" width="392"><font face="Arial" size="3"><input
      name="del_company" size="40" type="text" value=""></font></td>
    </tr>

    <tr>
      <td height="23" width="223" align="right"><font face="Arial" size="2">Address:</font></td>
      <td align="left" height="23" width="392"><font face="Arial" size="3"><input
      name="del_addr1" size="40" type="text" value=""></font></td>
    </tr>
    <tr align="center">
      <td height="23" width="223" align="right"></td>
      <td align="left" height="23" width="392"><font face="Arial" size="3"><input
      name="del_addr2" size="40" type="text" value=""></font></td>
    </tr>


    <tr align="center">
      <td height="23" width="223" align="right"><font face="Arial" size="2">Town/City:</font></td>
      <td align="left" height="23" width="392"><font face="Arial" size="3"><input
      name="del_city" size="40" type="text" value=""></font></td>
    </tr>
    <tr align="center">
      <td height="23" width="223" align="right"><font face="Arial" size="2">US State or Canadian
      Province:</font></td>
      <td align="left" height="23" width="392"><select name="del_state" size="1">
        <option selected value ="None">Select a State or Province</option>
        <option value="AB">Alberta</option>
        <option value="AL">Alabama</option>
        <option value="AK">Alaska</option>
        <option value="AZ">Arizona</option>
        <option value="AR">Arkansas</option>
        <option value="BC">British Columbia</option>
        <option value="CA">California</option>
        <option value="CO">Colorado</option>
        <option value="CT">Connecticut</option>
        <option value="DE">Delaware</option>
        <option value="DC">District of Columbia</option>
        <option value="FL">Florida</option>
        <option value="GA">Georgia</option>
        <option value="HI">Hawaii</option>
        <option value="ID">Idaho</option>
        <option value="IL">Illinois</option>
        <option value="IN">Indiana</option>
        <option value="IA">Iowa</option>
        <option value="KS">Kansas</option>
        <option value="KY">Kentucky</option>
        <option value="LA">Louisiana</option>
        <option value="MB">Manitoba</option>
        <option value="ME">Maine</option>
        <option value="MD">Maryland</option>
        <option value="MA">Massachusetts</option>
        <option value="MI">Michigan</option>
        <option value="MN">Minnesota</option>
        <option value="MS">Mississippi</option>
        <option value="MO">Missouri</option>
        <option value="MT">Montana</option>
        <option value="NE">Nebraska</option>
        <option value="NV">Nevada</option>
        <option value="NB">New Brunswick</option>
        <option value="NH">New Hampshire</option>
        <option value="NJ">New Jersey</option>
        <option value="NM">New Mexico</option>
        <option value="NY">New York</option>
        <option value="NC">North Carolina</option>
        <option value="ND">North Dakota</option>
        <option value="NL">Newfoundland</option>
        <option value="NS">Nova Scotia</option>
        <option value="NT">Northwest Territories</option>
        <option value="NU">Nunavut</option>
        <option value="OH">Ohio</option>
        <option value="OK">Oklahoma</option>
        <option value="ON">Ontario</option>
        <option value="OR">Oregon</option>
        <option value="PA">Pennsylvania</option>
        <option value="PE">Prince Edward Island</option>
        <option value="QC">Quebec</option>
        <option value="RI">Rhode Island</option>
        <option value="SK">Saskatchewan</option>
        <option value="SC">South Carolina</option>
        <option value="SD">South Dakota</option>
        <option value="TN">Tennessee</option>
        <option value="TX">Texas</option>
        <option value="UT">Utah</option>
        <option value="VT">Vermont</option>
        <option value="VA">Virginia</option>
        <option value="WA">Washington</option>
        <option value="WV">West Virginia</option>
        <option value="WI">Wisconsin</option>
        <option value="WY">Wyoming</option>
        <option value="YT">Yukon</option>
      </select> </td>
    </tr>
    <tr align="center">
      <td height="23" width="223" align="right"><font face="Arial" size="2">Country:</font></td>
      <td align="left" height="23" width="392"><select name="del_country" size="1">
        <option selected value ="None">Select a country </option>
        <option value="AF">Afghanistan </option>
        <option value="AL">Albania </option>
        <option value="DZ">Algeria </option>
        <option value="AS">American Samoa </option>
        <option value="AD">Andorra </option>
        <option value="AO">Angola </option>
        <option value="AI">Anguilla </option>
        <option value="AQ">Antarctica </option>
        <option value="AG">Antigua And Barbuda </option>
        <option value="AR">Argentina </option>
        <option value="AM">Armenia </option>
        <option value="AW">Aruba </option>
        <option value="AU">Australia </option>
        <option value="AT">Austria </option>
        <option value="AZ">Azerbaijan </option>
        <option value="BS">Bahamas </option>
        <option value="BH">Bahrain </option>
        <option value="BD">Bangladesh </option>
        <option value="BB">Barbados </option>
        <option value="BY">Belarus </option>
        <option value="BE">Belgium </option>
        <option value="BZ">Belize </option>
        <option value="BJ">Benin </option>
        <option value="BM">Bermuda </option>
        <option value="BT">Bhutan </option>
        <option value="BO">Bolivia </option>
        <option value="BA">Bosnia And Herzegowina </option>
        <option value="BW">Botswana </option>
        <option value="BV">Bouvet Island </option>
        <option value="BR">Brazil </option>
        <option value="IO">British Indian Ocean Territory </option>
        <option value="BN">Brunei Darussalam </option>
        <option value="BG">Bulgaria </option>
        <option value="BF">Burkina Faso </option>
        <option value="BI">Burundi </option>
        <option value="KH">Cambodia </option>
        <option value="CM">Cameroon </option>
        <option value="CA">Canada </option>
        <option value="CV">Cape Verde </option>
        <option value="KY">Cayman Islands </option>
        <option value="CF">Central African Republic </option>
        <option value="TD">Chad </option>
        <option value="CL">Chile </option>
        <option value="CN">China </option>
        <option value="CX">Christmas Island </option>
        <option value="CC">Cocos (Keeling) Islands </option>
        <option value="CO">Colombia </option>
        <option value="KM">Comoros </option>
        <option value="CG">Congo </option>
        <option value="CK">Cook Islands </option>
        <option value="CR">Costa Rica </option>
        <option value="CI">Cote DIvoire </option>
        <option value="HR">Croatia </option>
        <option value="CU">Cuba </option>
        <option value="CY">Cyprus </option>
        <option value="CZ">Czech Republic </option>
        <option value="DK">Denmark </option>
        <option value="DJ">Djibouti </option>
        <option value="DM">Dominica </option>
        <option value="DO">Dominican Republic </option>
        <option value="TP">East Timor </option>
        <option value="EC">Ecuador </option>
        <option value="EG">Egypt </option>
        <option value="SV">El Salvador </option>
        <option value="GQ">Equatorial Guinea </option>
        <option value="ER">Eritrea </option>
        <option value="EE">Estonia </option>
        <option value="ET">Ethiopia </option>
        <option value="FK">Falkland Islands </option>
        <option value="FO">Faroe Islands </option>
        <option value="FJ">Fiji </option>
        <option value="FI">Finland </option>
        <option value="FR">France </option>
        <option value="FX">France, Metropolitan </option>
        <option value="GF">French Guiana </option>
        <option value="PF">French Polynesia </option>
        <option value="TF">French Southern Territories </option>
        <option value="GA">Gabon </option>
        <option value="GM">Gambia </option>
        <option value="GE">Georgia </option>
        <option value="DE">Germany </option>
        <option value="GH">Ghana </option>
        <option value="GI">Gibraltar </option>
        <option value="GR">Greece </option>
        <option value="GL">Greenland </option>
        <option value="GD">Grenada </option>
        <option value="GP">Guadeloupe </option>
        <option value="GU">Guam </option>
        <option value="GT">Guatemala </option>
        <option value="GN">Guinea </option>
        <option value="GW">Guinea-Bissau </option>
        <option value="GY">Guyana </option>
        <option value="HT">Haiti </option>
        <option value="HM">Heard And Mc Donald Islands </option>
        <option value="HN">Honduras </option>
        <option value="HK">Hong Kong </option>
        <option value="HU">Hungary </option>
        <option value="IS">Iceland </option>
        <option value="IN">India </option>
        <option value="ID">Indonesia </option>
        <option value="IR">Iran </option>
        <option value="IQ">Iraq </option>
        <option value="IE">Ireland </option>
        <option value="IL">Israel </option>
        <option value="IT">Italy </option>
        <option value="JM">Jamaica </option>
        <option value="JP">Japan </option>
        <option value="JO">Jordan </option>
        <option value="KZ">Kazakhstan </option>
        <option value="KE">Kenya </option>
        <option value="KI">Kiribati </option>
        <option value="KP">North Korea </option>
        <option value="KR">South Korea </option>
        <option value="KW">Kuwait </option>
        <option value="KG">Kyrgyzstan </option>
        <option value="LA">Lao Peoples Republic </option>
        <option value="LV">Latvia </option>
        <option value="LB">Lebanon </option>
        <option value="LS">Lesotho </option>
        <option value="LR">Liberia </option>
        <option value="LY">Libyan Arab Jamahiriya </option>
        <option value="LI">Liechtenstein </option>
        <option value="LT">Lithuania </option>
        <option value="LU">Luxembourg </option>
        <option value="MO">Macau </option>
        <option value="MK">Macedonia </option>
        <option value="MG">Madagascar </option>
        <option value="MW">Malawi </option>
        <option value="MY">Malaysia </option>
        <option value="MV">Maldives </option>
        <option value="ML">Mali </option>
        <option value="MT">Malta </option>
        <option value="MH">Marshall Islands </option>
        <option value="MQ">Martinique </option>
        <option value="MR">Mauritania </option>
        <option value="MU">Mauritius </option>
        <option value="YT">Mayotte </option>
        <option value="MX">Mexico </option>
        <option value="FM">Micronesia </option>
        <option value="MD">Moldova </option>
        <option value="MC">Monaco </option>
        <option value="MN">Mongolia </option>
        <option value="MS">Montserrat </option>
        <option value="MA">Morocco </option>
        <option value="MZ">Mozambique </option>
        <option value="MM">Myanmar </option>
        <option value="NA">Namibia </option>
        <option value="NR">Nauru </option>
        <option value="NP">Nepal </option>
        <option value="NL">Netherlands </option>
        <option value="AN">Netherlands Antilles </option>
        <option value="NC">New Caledonia </option>
        <option value="NZ">New Zealand </option>
        <option value="NI">Nicaragua </option>
        <option value="NE">Niger </option>
        <option value="NG">Nigeria </option>
        <option value="NU">Niue </option>
        <option value="NF">Norfolk Island </option>
        <option value="MP">Northern Mariana Islands </option>
        <option value="NO">Norway </option>
        <option value="OM">Oman </option>
        <option value="PK">Pakistan </option>
        <option value="PW">Palau </option>
        <option value="PA">Panama </option>
        <option value="PG">Papua New Guinea </option>
        <option value="PY">Paraguay </option>
        <option value="PE">Peru </option>
        <option value="PH">Philippines </option>
        <option value="PN">Pitcairn </option>
        <option value="PL">Poland </option>
        <option value="PT">Portugal </option>
        <option value="PR">Puerto Rico </option>
        <option value="QA">Qatar </option>
        <option value="RE">Reunion </option>
        <option value="RO">Romania </option>
        <option value="RU">Russian Federation </option>
        <option value="RW">Rwanda </option>
        <option value="KN">Saint Kitts And Nevis </option>
        <option value="LC">Saint Lucia </option>
        <option value="VC">Saint Vincent And The Grenadines </option>
        <option value="WS">Samoa </option>
        <option value="SM">San Marino </option>
        <option value="ST">Sao Tome And Principe </option>
        <option value="SA">Saudi Arabia </option>
        <option value="SN">Senegal </option>
        <option value="SC">Seychelles </option>
        <option value="SL">Sierra Leone </option>
        <option value="SG">Singapore </option>
        <option value="SK">Slovakia </option>
        <option value="SI">Slovenia </option>
        <option value="SB">Solomon Islands </option>
        <option value="SO">Somalia </option>
        <option value="ZA">South Africa </option>
        <option value="GS">South Georgia And The South Sandwich Islands </option>
        <option value="ES">Spain </option>
        <option value="LK">Sri Lanka </option>
        <option value="SH">St Helena </option>
        <option value="PM">St Pierre and Miquelon </option>
        <option value="SD">Sudan </option>
        <option value="SR">Suriname </option>
        <option value="SJ">Svalbard And Jan Mayen Islands </option>
        <option value="SZ">Swaziland </option>
        <option value="SE">Sweden </option>
        <option value="CH">Switzerland </option>
        <option value="SY">Syrian Arab Republic </option>
        <option value="TW">Taiwan </option>
        <option value="TJ">Tajikistan </option>
        <option value="TZ">Tanzania </option>
        <option value="TH">Thailand </option>
        <option value="TG">Togo </option>
        <option value="TK">Tokelau </option>
        <option value="TO">Tonga </option>
        <option value="TT">Trinidad And Tobago </option>
        <option value="TN">Tunisia </option>
        <option value="TR">Turkey </option>
        <option value="TM">Turkmenistan </option>
        <option value="TC">Turks And Caicos Islands </option>
        <option value="TV">Tuvalu </option>
        <option value="UG">Uganda </option>
        <option value="UA">Ukraine </option>
tion>
        <option value="AE">United Arab Emirates </option>
        <option value="GB">United Kingdom</option>
        <option value="US">United States </option>
        <option value="UM">United States Minor Outlying Islands </option>
        <option value="UY">Uruguay </option>
        <option value="UZ">Uzbekistan </option>
        <option value="VU">Vanuatu </option>
        <option value="VA">Vatican City State </option>
        <option value="VE">Venezuela </option>
        <option value="VN">Viet Nam </option>
        <option value="VG">Virgin Islands (British) </option>
        <option value="VI">Virgin Islands (U.S.) </option>
        <option value="WF">Wallis And Futuna Islands </option>
        <option value="EH">Western Sahara </option>
        <option value="YE">Yemen </option>
        <option value="ZR">Zaire </option>
        <option value="ZM">Zambia </option>
        <option value="ZW">Zimbabwe </option>
        <option value="ZZ">Other-Not Shown </option>
      </select></td>
    </tr>
    <tr align="center">
      <td height="1" width="223" align="right"><font face="Arial" size="2">Post/Zip/Area Code:</font></td>
      <td align="left" height="1" width="392"><font face="Arial" size="3"><input
      name="del_postalcode" size="20" type="text" value=""></font></td>
    </tr>
    <tr align="center">
      <td height="1" width="223">&nbsp;&nbsp;</td>
      <td align="left" height="1" width="392"></td>
    </tr>
    <tr align="center">
      <td height="1" width="615" colspan="2" style="background-color: rgb(0,128,128)"
      align="left">&nbsp;&nbsp;</td>
    </tr>
    <tr>
      <td height="1" width="223">&nbsp;&nbsp;</td>
      <td align="left" height="1" width="392"></td>
    </tr>
    <tr>
      <td height="1" width="223" align="right"><font face="Arial" size="2">&nbsp;&nbsp;Customer
      ID: </font></td>
      <td align="left" height="1" width="392"><font face="Arial" size="3"><input
      name="x_cust_id" size="20" type="text" value="" maxlength="20"></font></td>
    </tr>
    <tr>
      <td height="1" width="223" align="right"><font face="Arial" size="2">&nbsp;&nbsp;Purchase
      Number: </font></td>
      <td align="left" height="1" width="392"><font face="Arial" size="3"><input name="x_po_num"
      size="20" type="text" value="" maxlength="25"></font></td>
    </tr>
    <tr>
      <td height="1" width="223">&nbsp;&nbsp;</td>
      <td align="left" height="1" width="392"></td>
    </tr>
    <tr>
      <td height="1" width="615" colspan="2" style="background-color: rgb(0,128,128)"
      align="left">&nbsp;&nbsp;</td>
    </tr>
    <tr align="center">
      <td height="1" width="223">&nbsp;&nbsp;</td>
      <td align="left" height="1" width="392"></td>
    </tr>
    <tr align="center">
      <td height="1" width="223">&nbsp;&nbsp;</td>
      <td align="left" height="1" width="392"><font face="Arial" size="3"><input
      value="Place Order" name="B1" type="submit"> <input value="Reset" name="B2" type="reset"></font>&nbsp;
      </td>
    </tr>
</tbody>
  </table>
<!--paypal_pro_2-->
</form>

<p align="center">&nbsp;</p>

<p align="center">&nbsp;</p>
<!--show_info-->

<p align="center">&nbsp;</p>
</body>
</html>';


 my $insert =""; 

   while(my($first,$last) = each(%q))
      {
      if(!($first =~ /submit/i)) 
         {	
	     if($first ne 'p') 
            {        
            $insert= $insert . "<input type='hidden' name='$first' value='$last'>" . "\r\n";
            }	
         }
      }
   
      
   $out =~ s/<!--paypal_pro_2-->/$insert/;  
      
  # $insert= $insert . "<input type='hidden' name='s' value='o'>" . "\r\n";
  # $out =~ s/<!--paypal_pro_1-->/$insert/;  



return $out;
} 
 
 
# Subroutine to handle basic decoding of URL data.
sub url_decode {
    my ($s) = @_;

    # Translate + to space, and %XX to the character code.

    $s =~ tr/+/ /;
    $s =~ s/%([0-9A-F][0-9A-F])/pack("C",oct("0x$1"))/gie;
    return $s;
}


sub uri_escape {
	my $text = $_[0];
	return undef unless defined $text;

	# Build a char to hex map
	my %escapes = ();
	for (0..255) {
		$escapes{chr($_)} = sprintf("%%%02X", $_);
	}

	# Default unsafe characters.  RFC 2732 ^(uric - reserved)
	$text =~ s/([\%])/$escapes{$1}/g;
   # $text =~ s/([\"\+\;\,\=\&\:])/$escapes{$1}/g;
    $text =~ s/([\"\+\;\,\=\&\:\_\r\n])/$escapes{$1}/g;
	$text =~ s/ /\+/g;


	$text;
}

sub uri_unescape
   {
   my ($s) = @_;
   $s =~ s/\+/ /g;
   $s =~ s/%([0-9A-Fa-f]{2})/chr(hex($1))/eg; 
	
   return($s);
   }
